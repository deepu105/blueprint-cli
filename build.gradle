plugins {
    id 'com.github.blindpirate.gogradle' version '0.10'
}

golang {
    packagePath = 'github.com/xebialabs/xl-cli' // go import path of project to be built, NOT local file system path!
}

dependencies {
    golang {
        build(['name': 'github.com/mitchellh/go-homedir'])
        build(['name': 'github.com/spf13/cobra'])
        build(['name': 'github.com/spf13/viper'])
    }
}

build {
    // Cross-compile platforms, update as necessary.
    targetPlatform = [
            'darwin-amd64', 'linux-amd64', 'windows-amd64'
    ]

    // The ${} placeholder will be rendered in cross-compile
    go 'build -o ./build/${GOOS}_${GOARCH}/xl${GOEXE} cmd/xl/main.go'
}

clean.doFirst {
    delete 'build'
}
